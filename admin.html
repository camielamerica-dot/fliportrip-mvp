<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlipOrTrip | Admin Suite v1.9.2</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;800&display=swap" rel="stylesheet">
    
    <style>
        :root { --mint: #00FFC2; --obsidian: #0B0E14; --card-bg: #161B22; --text-muted: #8899A6; }
        body { background: var(--obsidian); color: white; font-family: 'Plus Jakarta Sans', sans-serif; margin: 0; display: flex; height: 100vh; }
        
        .sidebar { width: 260px; background: var(--card-bg); padding: 30px; border-right: 1px solid rgba(0,255,194,0.1); flex-shrink: 0; }
        .nav-btn { background: transparent; border: none; color: var(--text-muted); padding: 15px; text-align: left; font-size: 14px; font-weight: 800; cursor: pointer; width: 100%; border-radius: 12px; margin-bottom: 5px; }
        .nav-btn.active { background: rgba(0,255,194,0.1); color: var(--mint); }

        .main-content { flex: 1; padding: 40px; overflow-y: auto; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* FORM */
        .form-container { background: var(--card-bg); padding: 25px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.05); }
        .label { font-size: 10px; color: var(--mint); text-transform: uppercase; font-weight: 800; margin-bottom: 5px; display: block; }
        input, textarea { background: #0B0E14; border: 1px solid rgba(255,255,255,0.1); color: white; padding: 12px; width: 100%; border-radius: 10px; margin-bottom: 15px; font-family: inherit; }
        
        /* THE GOOGLE FIX */
        .pac-container { 
            z-index: 100000 !important; 
            background-color: #1e252e !important; 
            border: 1px solid #00FFC2 !important;
            border-radius: 8px;
            margin-top: 5px;
        }
        .pac-item { color: #fff !important; padding: 10px; border-top: 1px solid rgba(255,255,255,0.1); cursor: pointer; }
        .pac-item:hover { background: rgba(0,255,194,0.1); }
        .pac-item-query { color: #00FFC2 !important; font-size: 14px; }

        .img-preview { width: 100%; height: 100px; background: #000; border-radius: 10px; margin-bottom: 15px; overflow: hidden; display: flex; align-items: center; justify-content: center; border: 1px dashed #333; }
        .img-preview img { width: 100%; height: 100%; object-fit: cover; }
        
        .btn-save { background: var(--mint); color: #000; border: none; padding: 15px; border-radius: 30px; font-weight: 800; width: 100%; cursor: pointer; text-transform: uppercase; }
        #login-gate { position: fixed; inset: 0; background: var(--obsidian); z-index: 9999; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="login-gate">
    <div style="text-align:center; background:var(--card-bg); padding:40px; border-radius:20px; border: 1px solid var(--mint);">
        <img src="https://wijzijnvalkenburg.nl/wp-content/uploads/2026/02/fliportrip_logo.png" width="100">
        <h2 style="color:var(--mint)">ADMIN</h2>
        <input type="password" id="pw" placeholder="Wachtwoord" style="text-align:center">
        <button class="btn-save" onclick="checkLogin()">Inloggen</button>
    </div>
</div>

<div class="sidebar">
    <img src="https://wijzijnvalkenburg.nl/wp-content/uploads/2026/02/fliportrip_logo.png" width="120" style="margin-bottom:30px">
    <button class="nav-btn active" onclick="showTab('tab-activities', this)">ðŸŽ¡ Catalogus</button>
    <button class="nav-btn" onclick="showTab('tab-stats', this)">ðŸ“Š Statistieken</button>
</div>

<div class="main-content">
    <div id="tab-activities" class="tab-content active">
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:30px;">
            <div class="form-container">
                <span class="label">Naam Activiteit</span>
                <input type="text" id="act-title" placeholder="MergelRijk">

                <span class="label">Locatie (Typ om te zoeken)</span>
                <input type="text" id="act-loc" placeholder="Adres in Valkenburg...">
                
                <div style="display:flex; gap:10px;">
                    <div style="flex:1"><span class="label">Lat</span><input type="text" id="act-lat" readonly opacity="0.5"></div>
                    <div style="flex:1"><span class="label">Lng</span><input type="text" id="act-lng" readonly opacity="0.5"></div>
                </div>

                <span class="label">Prijs</span>
                <input type="text" id="act-price" placeholder="Bijv: â‚¬15,50">

                <span class="label">Affiliate Link</span>
                <input type="text" id="act-url" placeholder="https://vakantieveilingen.nl/...">

                <span class="label">Afbeelding URL</span>
                <input type="text" id="act-img" oninput="document.getElementById('p-img').src=this.value">
                <div class="img-preview"><img id="p-img" src=""></div>

                <button class="btn-save" onclick="saveData()">Opslaan in Firebase</button>
            </div>

            <div>
                <h3>Huidige Items</h3>
                <div id="list-items">Laden...</div>
            </div>
        </div>
    </div>
    
    <div id="tab-stats" class="tab-content">
        <h2>Statistieken</h2>
        <div style="height:400px; background:var(--card-bg); padding:20px; border-radius:20px;">
            <canvas id="myChart"></canvas>
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs, addDoc, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAx_XDqOW9hth7dwSFBZYJnk_dTa2lnvQ0",
        authDomain: "fliportrip-valkenburg.firebaseapp.com",
        projectId: "fliportrip-valkenburg",
        storageBucket: "fliportrip-valkenburg.firebasestorage.app",
        messagingSenderId: "1050989330669",
        appId: "1:1050989330669:web:6649f61cbec8ee3b3f8ce4"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // LOGIN CHECK
    window.checkLogin = () => {
        if(document.getElementById('pw').value === 'Flip2026') {
            document.getElementById('login-gate').style.display = 'none';
            initGoogle();
            loadItems();
        } else alert('Fout!');
    }

    // TABS
    window.showTab = (id, btn) => {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    // GOOGLE AUTOCOMPLETE INITIALISATIE
    function initGoogle() {
        const input = document.getElementById('act-loc');
        const autocomplete = new google.maps.places.Autocomplete(input);
        
        // Luister naar selectie
        autocomplete.addListener('place_changed', () => {
            const place = autocomplete.getPlace();
            if(!place.geometry) {
                alert("Kies een locatie uit de lijst die verschijnt tijdens het typen.");
                return;
            }
            document.getElementById('act-lat').value = place.geometry.location.lat();
            document.getElementById('act-lng').value = place.geometry.location.lng();
            document.getElementById('act-loc').value = place.formatted_address;
        });
    }

    // FIREBASE SAVE
    window.saveData = async () => {
        const payload = {
            title: document.getElementById('act-title').value,
            location: document.getElementById('act-loc').value,
            lat: document.getElementById('act-lat').value,
            lng: document.getElementById('act-lng').value,
            price: document.getElementById('act-price').value,
            bookingUrl: document.getElementById('act-url').value,
            image: document.getElementById('act-img').value
        };

        try {
            await addDoc(collection(db, "activities"), payload);
            alert("Succesvol opgeslagen!");
            location.reload();
        } catch(e) { alert("Fout: " + e.message); }
    }

    async function loadItems() {
        const snap = await getDocs(collection(db, "activities"));
        let h = "";
        snap.forEach(d => {
            const a = d.data();
            h += `<div style="background:rgba(255,255,255,0.05); padding:10px; margin-bottom:5px; border-radius:10px; display:flex; justify-content:space-between;">
                    <span>${a.title}</span>
                    <span style="color:var(--mint)">${a.price}</span>
                  </div>`;
        });
        document.getElementById('list-items').innerHTML = h;
    }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGms1-wiv_5tq1ehzhhJOjM905WnFMexo&libraries=places"></script>

</body>
</html>
